<?php
use Illuminate\Database\Migrations\Migration; use Illuminate\Database\Schema\Blueprint; use Illuminate\Support\Facades\Schema;
return new class extends Migration { public function up(): void { Schema::table('sales', function (Blueprint $t) { if (!Schema::hasColumn('sales','store_id')) { $t->foreignId('store_id')->nullable()->constrained('stores')->nullOnDelete(); } if (!Schema::hasColumn('sales','customer_id')) { $t->foreignId('customer_id')->nullable()->constrained('customers')->nullOnDelete(); } if (!Schema::hasColumn('sales','payment_status')) { $t->enum('payment_status',['unpaid','paid','partial'])->default('paid'); } if (!Schema::hasColumn('sales','midtrans_order_id')) { $t->string('midtrans_order_id')->nullable(); } if (!Schema::hasColumn('sales','midtrans_token')) { $t->string('midtrans_token')->nullable(); } }); }
public function down(): void { Schema::table('sales', function (Blueprint $t) { if (Schema::hasColumn('sales','store_id')) { $t->dropConstrainedForeignId('store_id'); } if (Schema::hasColumn('sales','customer_id')) { $t->dropConstrainedForeignId('customer_id'); } if (Schema::hasColumn('sales','payment_status')) { $t->dropColumn('payment_status'); } if (Schema::hasColumn('sales','midtrans_order_id')) { $t->dropColumn('midtrans_order_id'); } if (Schema::hasColumn('sales','midtrans_token')) { $t->dropColumn('midtrans_token'); } }); } };
